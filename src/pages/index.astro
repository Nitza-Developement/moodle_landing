---
import MainLayout from "../layouts/MainLayout.astro";
import Card from "../components/Card.astro";
import Button from "../components/Button.astro";
import Badge from "../components/Badge.astro";
import Reviews from "../components/Reviews.astro";
import ReviewBars from "../components/ReviewBars.astro";

// i18n setup
import en from "../i18n/locales/en.json";
import es from "../i18n/locales/es.json";

const translations = { en, es };
const locale = Astro.currentLocale ?? "en";
const t = translations[locale as keyof typeof translations] ?? en;

// Get cards content from translations
const cardsContent = t.cardsContent ?? [];

// Button texts from translations
const buttonPrimaryText = t.buttons?.buttonPrimary?.text ?? "Primary";
const buttonLargeText = t.buttons?.buttonLarge?.text ?? "Large";
const buttonIconTextText = t.buttons?.buttonIconText?.text ?? "Icon Text";

// Badge texts from translations
const badgeDefaultText = t.badges?.Default?.text ?? "Default";
const badgeWarningText = t.badges?.Warning?.text ?? "Warning";
const badgeErrorText = t.badges?.Error?.text ?? "Error";
const badgeNotificationsText = t.badges?.Notifications?.text ?? "Notifications";
---

<MainLayout
  title="Moodle Landing"
  description="Welcome to our Moodle Landing page"
>
  <div class="flex flex-wrap gap-8 p-8 justify-center">
    {
      cardsContent.map((cardContent: any, index: number) => (
        <Card cardContent={cardContent} key={index} />
      ))
    }
  </div>

  <div class="p-8 space-y-4">
    <div class="flex flex-wrap gap-4">
      <Button
        text={buttonPrimaryText}
        variant="Primary"
        data-button-action
        data-params={JSON.stringify({ valor1: "valor1" })}
      />
      <Button text={buttonLargeText} variant="Large" />
      <Button
        text={buttonIconTextText}
        variant="IconText"
        iconName="phone-arrow-down-left"
      />
      <Button variant="Icon" iconName="phone-arrow-down-left" />
    </div>

    <div class="flex flex-wrap gap-4">
      <Badge text={badgeDefaultText} type="Default" />
      <Badge text={badgeWarningText} type="Default" />
      <Badge text={badgeErrorText} type="Default" />
      <Badge text={badgeNotificationsText} type="count" count={8} />
    </div>
  </div>

  <!-- <Reviews /> -->

  <div class="p-8 space-y-4">
    <ReviewBars
      img="https://coderthemes.com/yum/assets/avatar1-25906796.png"
      name="Jakob Culhane"
      stars={4}
      text="Healthy and Delicious Food"
    />

    <ReviewBars
      img="https://coderthemes.com/yum/assets/burger-1-0c3ba5a6.svg"
      name="MCD Veg Burger"
      stars={5}
      signal="$"
      text2="8.14"
    />
  </div>
</MainLayout>

<script>
  // Client-side JavaScript for button click handlers
  document.querySelectorAll("[data-button-action]").forEach((button) => {
    button.addEventListener("click", (e) => {
      const target = e.currentTarget as HTMLElement;
      const params = target.dataset.params;

      if (params) {
        console.log("click: ", JSON.parse(params));
      } else {
        console.log("click");
      }
    });
  });
</script>
